(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,53674,(e,t,s)=>{t.exports=e.r(36518)},41601,e=>{"use strict";var t=e.i(52608),s=e.i(43942),a=e.i(53674),r=e.i(35683),l=e.i(95323),n=e.i(93768),i=e.i(67879);let c=(0,e.i(87722).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var d=e.i(60885);function x(){let e=(0,a.useSearchParams)().get("q")||"",{showLoading:x,hideLoading:o,showLoadingWithProgress:m,updateProgress:h}=(0,d.useLoading)(),[u,g]=(0,s.useState)(null),[j,y]=(0,s.useState)([]),[f,b]=(0,s.useState)(!1),[p,v]=(0,s.useState)(null),[N,w]=(0,s.useState)(0),[S,k]=(0,s.useState)(!0),I=(0,s.useRef)(null);(0,s.useEffect)(()=>{e&&C()},[e]),(0,s.useEffect)(()=>{let e=new IntersectionObserver(e=>{e[0].isIntersecting&&S&&!f&&T()},{threshold:.1});return I.current&&e.observe(I.current),()=>{I.current&&e.unobserve(I.current)}},[S,f]);let C=async()=>{try{m("搜索中..."),v(null),h(20);let t=await (0,i.searchImages)(e,0,10);h(80),y(t),w(10),k(t.length>=10),h(100)}catch(e){v("搜索失败，请稍后重试"),console.error("Failed to search images:",e)}finally{setTimeout(()=>o(),300)}},T=async()=>{try{b(!0);let t=await (0,i.searchImages)(e,N,10);y(e=>{let s=new Set(e.map(e=>e.id)),a=t.filter(e=>!s.has(e.id));return[...e,...a]}),w(e=>e+10),k(t.length>=10)}catch(e){console.error("Failed to load more images:",e)}finally{b(!1)}};return p?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"搜索失败"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:p}),(0,t.jsx)("button",{onClick:C,className:"bg-black text-white px-6 py-3 rounded-xl font-semibold hover:bg-gray-800 transition",children:"重新搜索"})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:[(0,t.jsx)(r.Header,{}),(0,t.jsx)("div",{className:"max-w-4xl mx-auto mb-6",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("button",{onClick:()=>window.location.href="/",className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:(0,t.jsx)(c,{size:20})}),(0,t.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:["搜索结果: ",(0,t.jsxs)("span",{className:"text-gray-600",children:['"',e,'"']})]})]})}),0===j.length?(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("img",{src:"/search.png",alt:"搜索",className:"w-24 h-24 mx-auto mb-4 opacity-60"}),(0,t.jsx)("p",{className:"text-gray-600 text-lg",children:"没有找到相关图片"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.GalleryGrid,{items:j,onItemClick:e=>g(e)}),f&&(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}),!S&&j.length>0&&(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"没有更多图片了"}),(0,t.jsx)("div",{ref:I,className:"h-1"})]}),(0,t.jsx)(n.ImageModal,{selectedItem:u,onClose:()=>g(null),onDescriptionUpdate:(e,t)=>{y(s=>s.map(s=>s.id===e?{...s,description:t}:s)),u&&u.id===e&&g(e=>e?{...e,description:t}:null)}})]})}function o(){return(0,t.jsx)(s.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}),children:(0,t.jsx)(x,{})})}e.s(["default",()=>o],41601)}]);