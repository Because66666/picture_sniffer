(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5860,e=>{"use strict";var t=e.i(52608),s=e.i(43942),r=e.i(35683),l=e.i(95323),a=e.i(93768),n=e.i(67879),i=e.i(60885);function c(){let{showLoading:e,hideLoading:c,showLoadingWithProgress:d,updateProgress:o}=(0,i.useLoading)(),[m,u]=(0,s.useState)(null),[x,h]=(0,s.useState)([]),[g,f]=(0,s.useState)(!1),[b,y]=(0,s.useState)(null),[j,v]=(0,s.useState)(0),[p,N]=(0,s.useState)(!0),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{w()},[]),(0,s.useEffect)(()=>{let e=new IntersectionObserver(e=>{e[0].isIntersecting&&p&&!g&&I()},{threshold:.1});return S.current&&e.observe(S.current),()=>{S.current&&e.unobserve(S.current)}},[p,g]);let w=async()=>{try{d("加载中..."),y(null),o(20);let e=await (0,n.fetchRandomImages)(0,10);o(80),h(e),v(10),N(e.length>=10),o(100)}catch(e){y("加载图片失败，请稍后重试"),console.error("Failed to load images:",e)}finally{setTimeout(()=>c(),300)}},I=async()=>{try{f(!0);let e=await (0,n.fetchRandomImages)(j,10);h(t=>{let s=new Set(t.map(e=>e.id)),r=e.filter(e=>!s.has(e.id));return[...t,...r]}),v(e=>e+10),N(e.length>=10)}catch(e){console.error("Failed to load more images:",e)}finally{f(!1)}};return b?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"加载失败"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:b}),(0,t.jsx)("button",{onClick:w,className:"bg-black text-white px-6 py-3 rounded-xl font-semibold hover:bg-gray-800 transition",children:"重新加载"})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8",children:[(0,t.jsx)(r.Header,{}),(0,t.jsx)(l.GalleryGrid,{items:x,onItemClick:e=>u(e)}),g&&(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}),!p&&x.length>0&&(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:"没有更多图片了"}),(0,t.jsx)("div",{ref:S,className:"h-1"}),(0,t.jsx)(a.ImageModal,{selectedItem:m,onClose:()=>u(null)})]})}e.s(["default",()=>c])}]);